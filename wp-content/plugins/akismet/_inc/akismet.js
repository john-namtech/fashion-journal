jQuery(function(t){function e(o,s){t(".checkforspam-progress").text(t(".checkforspam").data("progress-label-format").replace("%1$s",o)),t.post(ajaxurl,{action:"akismet_recheck_queue",offset:o,limit:s},function(a){r+=a.counts.processed,i+=a.counts.spam,a.counts.processed<s?window.location.href=t(".checkforspam").data("success-url").replace("__recheck_count__",r).replace("__spam_count__",i):e(o+s-a.counts.spam,s)})}function o(){t("#the-comment-list").find('tr.comment, tr[id ^= "comment-"]').find('.column-author a[href^="http"]:first').each(function(){if(!(t(this).parent().find(".akismet_remove_url").length>0)){var e=t(this).attr("href"),o=document.location.href.split("/"),s=o[0]+"//"+o[2]+"/";if(0!=e.indexOf(s)){var a=t(this).parents("tr:first").attr("id").split("-");t(this).attr("id","author_comment_url_"+a[1]).after(t('<a href="#" class="akismet_remove_url">x</a>').attr("commentid",a[1]).attr("title",WPAkismet.strings["Remove this URL"]))}}})}var s=null,a=null,n=null;t(".akismet-status").each(function(){var e=t(this).attr("commentid");t(this).prependTo("#comment-"+e+" .column-comment")}),t(".akismet-user-comment-count").each(function(){var e=t(this).attr("commentid");t(this).insertAfter("#comment-"+e+" .author strong:first").show()}),o(),t("#the-comment-list").on("click",".akismet_remove_url",function(){var e=t(this).attr("commentid"),o={action:"comment_author_deurl",_wpnonce:WPAkismet.comment_author_url_nonce,id:e};return t.ajax({url:ajaxurl,type:"POST",data:o,beforeSend:function(){t("a[commentid='"+e+"']").hide(),t("#author_comment_url_"+e).html(t("<span/>").text(WPAkismet.strings["Removing..."]))},success:function(o){o&&t("#author_comment_url_"+e).attr("cid",e).addClass("akismet_undo_link_removal").html(t("<span/>").text(WPAkismet.strings["URL removed"])).append(" ").append(t("<span/>").text(WPAkismet.strings["(undo)"]).addClass("akismet-span-link"))}}),!1}).on("click",".akismet_undo_link_removal",function(){var e=t(this).attr("cid"),o=t(this).attr("href"),s={action:"comment_author_reurl",_wpnonce:WPAkismet.comment_author_url_nonce,id:e,url:o};return t.ajax({url:ajaxurl,type:"POST",data:s,beforeSend:function(){t("#author_comment_url_"+e).html(t("<span/>").text(WPAkismet.strings["Re-adding..."]))},success:function(s){s&&(t("a[commentid='"+e+"']").show(),t("#author_comment_url_"+e).removeClass("akismet_undo_link_removal").text(o.replace(/^http:\/\/(www\.)?/gi,"")))}}),!1}),t("#the-comment-list").on("mouseover",'a[id^="author_comment_url"], tr.pingback td.column-author a:first-of-type, td.comment p a',function(){if(clearTimeout(s),t(".akismet-mshot").length>0){if(t(".akismet-mshot:first").data("link")==this)return;t(".akismet-mshot").remove()}clearTimeout(a),clearTimeout(n);var e=encodeURIComponent(t(this).attr("href")),o=t('<div class="akismet-mshot mshot-container"><div class="mshot-arrow"></div><img src="//s0.wordpress.com/mshots/v1/'+e+'?w=900" width="450" height="338" class="mshot-image" /></div>');o.data("link",this);var i=t(this).offset();o.offset({left:Math.min(t(window).width()-475,i.left+t(this).width()+10),top:i.top+t(this).height()/2-101}),a=setTimeout(function(){o.find(".mshot-image").attr("src","//s0.wordpress.com/mshots/v1/"+e+"?w=900&r=2")},6e3),n=setTimeout(function(){o.find(".mshot-image").attr("src","//s0.wordpress.com/mshots/v1/"+e+"?w=900&r=3")},12e3),t("body").append(o)}).on("mouseout",'a[id^="author_comment_url"], tr.pingback td.column-author a:first-of-type, td.comment p a',function(){s=setTimeout(function(){clearTimeout(a),clearTimeout(n),t(".akismet-mshot").remove()},200)}),t(".checkforspam:not(.button-disabled)").click(function(o){o.preventDefault(),t(".checkforspam:not(.button-disabled)").addClass("button-disabled"),t(".checkforspam-spinner").addClass("spinner").addClass("is-active"),t(".checkforspam .akismet-label").text(t(".checkforspam").data("active-label")),e(0,100)});var i=0,r=0;if("start_recheck"in WPAkismet&&WPAkismet.start_recheck&&t(".checkforspam").click(),"undefined"!=typeof MutationObserver){var m=document.getElementById("the-comment-list");m&&new MutationObserver(function(t){for(var e=0,s=t.length;e<s;e++)if(t[e].addedNodes.length>0){o();break}}).observe(m,{attributes:!0,childList:!0,characterData:!0})}});